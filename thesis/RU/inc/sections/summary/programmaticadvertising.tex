\subsection{Алгоритмическая покупка рекламы}
\subsubsection{Основные термины и понятия}

Алгоритмическая покупка рекламы --- это способ автоматизированной доставки цифрового рекламного содержимого,
например, рекламного содержимого интернет-страниц, в режиме реального времени, основанный на индивидуальных 
особенностях каждого отдельного события доставки. (Oliver Busch Editor Programmatic Advertising)
\input{inc/images/rtb.tex}

На рисунке~\ref{img:pragrammatic-advertising} отображена схема одной из моделей реализации 
алгоритмической покупки рекламы RTB (англ. Real-Time Bidding, покупка в реальном времени). При посещении пользователем интернет ресурса 
с рекламным элементом, браузер собирает доступную о пользователе информацию 
(cookie информацию, техническую информацию об устройстве, местоположении) и отправляет запрос в систему SSP 
(уведомляет SSP о показе рекламного элемента интернет-страницы пользователю).

SSP (англ. Supply Side Platform) --- комплекс аппаратных и программных средств, предназначенных для продажи 
рекламного места.

Рекламный элемент (англ. Advertising Unit) --- набор элементов интернет страницы, предназначенный для 
отображения рекламного содержимого и предоставления возможности взаимодействия с ним.

SSP на основании переданной браузером информации объявляет данный рекламный элемент как доступный для 
продажи на аукционе. Следующим шагом, является уведомление рекламодателей через DSP о возможности покупки
данного рекламного места.

DSP (англ. Demand Side Platform) --- комплекс аппаратных и программных средств, предназначенных для предоставления
рекламного содержимого для дальнейшей продажи.

DSP осуществляют ставки на данное рекламное место и, выбирает из предложенных рекламодателями рекламных содержимых,
содержимое для показа. Критерий для отбора содержимого  при этом оценивая пользователя на основе предоставленной
SSP информацией и дополняя информацию о пользователе из внешних источников (DMP (Data Managment Platform) --- 
систем управления данными). На конечном этапе рекламное содержимое победителя аукциона доставляется через SSP и
браузер конечному пользователю путем показа на рекламном месте (рекламном элементе).

Взаимодействие пользователя с рекламным элементом (Impression) --- событие просмотра пользователем содержимого
рекламного элемента интернет-страницы, сопровождающееся сбором с согласия пользователя сведений, передаваемых 
системам продажи-покупки рекламы.

Число взаимодействий (Impressions amount) --- число взаимодействий пользователей с конкретным рекламным элементом
интернет-страницы, осуществленных за определенный период времени.

Число уникальных пользователей (Uniques amount) --- число неповторяющихся пользователей, осуществивших взаимодействие
с конкретным рекламным элементом интернет-страницы за определенный период времени.

\subsubsection{Количественная оценка взаимодействий пользователей с рекламными элементами}

Основным источником данных о пользовательских посещениях интернет-страниц (информация о пользовательском траффике,
пользовательском поведении) является протокол работы системы продажи-покупки рекламного содержимого. Протокол работы
представляет собой файл или совокупность файлов, в котором содержатся данные о взаимодействиях пользователей с
рекламным содержимым интернет-страниц в хронологическом порядке. Чаще всего каждое взаимодействие описывается информацией,
собранной интернет-обозревателем (веб-браузером), информацией, полученной из внешних источников, и набором технических
мета-данных, сгенерированных в процессе розыгрыша рекламного места. 

Пример формата данных, содержащихся в данном протоколе, описан в таблице \ref{tab:feature-description}.

\tabulinesep = 7pt
\begin{longtabu} to \textwidth {|X|X|X|}
        \caption{Описание признаков взаимодействия}
        \label{tab:feature-description}
        \endfirsthead
        \endhead
        \rowfont[c]{\bfseries}
        \hline
        Название поля & Описание & Множество допустимых значений \\
        \hline
        Идентификатор пользователя
        & Уникальный идентификатор пользователя, присваиваемый ему рекламным сервером
        & Строка, генерируемая согласно внутренней логике рекламного сервера \\
        \hline
        Идентификатор рекламного элемента
        & Уникальный идентификатор рекламного взаимодействия, с которым пользователь взаимодействовал
        & Целое число, генерируемое согласно внутренней логике рекламного сервера \\
        \hline
        Время взаимодействия 
        & Время взаимодействия пользователя с рекламным элементом в формате Unix-time
        & Целое число \\
        \hline
        Идентификатор географического положения пользователя 
        & Уникальный идентификатор географического положения пользователя
        & Целое число, генерируемое согласно внутренней логике рекламного сервера \\
        \hline
        Идентификатор используемого обозревателя интернет страниц 
        & Уникальный идентификатор интернет обозревателя, при помощи которого пользователь совершил
        взаимодействие с рекламным элементом
        & Целое число, генерируемое согласно внутренней логике рекламного сервера \\
        \hline
        Идентификатор операционной системы
        & Уникальный идентификатор операционной системы устройства, при помощи которого пользователь совершил
        взаимодействие с рекламным элементом
        & Целое число, генерируемое согласно внутренней логике рекламного сервера \\
        \hline
\end{longtabu}


Для количественного описания пользовательского поведения служат метрики количества взаимодействий пользователей
с рекламным содержимым интернет страниц и количества уникальных пользователей, взаимодействующий с рекламным
содержимым интернет страниц.

Представим каждое взаимодействие пользователя с рекламными элементыми в виде вектора $\mathbf{U}$, элементами которого
являются признаки взаимодействия (данные, содержащиеся в журнале работы рекламной системы).
\begin{equation}
    \mathbf{U_i} = \left(u_0, \dots, u_n \right), i = \overline{1, M}, n = \overline{0, N},
\end{equation}
где $M$ -- общее число взаимодействий, содержащихся в исходном протоколе работы рекламной системы, $N$ -- число признаков
взаимодействия.

В таблице~\ref{tab:feature-description} указано, что одним из полей протокола работы рекламной системы является метка
времени взаимодействия. Тогда множество векторов $\mathbf{U_i}$ представляет собой мномерный временной ряд. При этом 
различные события, например, взаимодействие различных пользователей с одним и тем же рекламным элементом могут
происходить в один и тот же момент времени.
\begin{equation}
    \mathbf{U_i} = \left(t_k, u_1, \dots, u_n \right), i = \overline{1, M}, n = \overline{1, N}, k = \overline{1, K},
\end{equation}
где $M$ -- общее число взаимодействий, содержащихся в исходном протоколе работы рекламной системы, $N$ -- число признаков
взаимодействия, $K$ -- число временных отсчетов.

Пусть дана выборка пользователей $\left\{ \mathbf{U} \right\}$ за период времени $\left[T_0, T_1\right]$. Пусть $u_i$
элемент вектора взаимодействия $U$ содержит значение идентификатора пользователя, совершившего взаимодействие, а $u_j$ -- 
индентификатор рекламного элемента, с которым взаимодействие было совершено, тогда
\begin{equation}
    \text{Imps} \left( U, A, t_k, \left\{ \mathbf{U} \right\} \right) =
        \begin{cases}
            1, u_i = U \wedge u_j = A  \\
            0, u_i \neq U \vee u_j \neq A
        \end{cases}, \forall t_k \in \left[T_0, T_1\right]
\end{equation}
функция взаимодействия пользователя $U$ с рекламным элементом $A$ в момент времени $t_k$. 

Метрика количества взаимодействий пользователя $U$ с рекламным элементом $A$ за период $\left[T_0, T_1\right]$ 
будет выглядеть следующим образом
\begin{equation}
    \text{Imps} \left( U, A, T_0, T_1, \left\{ \mathbf{U} \right\} \right) =
    \sum \limits_{t=T_0}^{T_1} \text{Imps} \left( U, A, t, \left\{ \mathbf{U} \right\} \right) 
\end{equation}

Метрика количества взаимодействий является аддитивной величиной. Данное свойство позволяет строить набор производных
метрик. Так, для определения количества пользовательских взаимодействий с рекламным элементом $A$ достаточно просуммировать 
взаимодействия отдельных пользователей
\begin{equation}
    \text{Imps} \left(A, T_0, T_1, \left\{ \mathbf{U} \right\} \right) =
    \sum \limits_{\forall u_i} \text{Imps} \left( u_i, A, T_0, T_1, \left\{ \mathbf{U} \right\} \right)
\end{equation}

Аналогично, для определения всех пользовательских взаимодействий достаточно просуммировать взаимодействия отдельных
рекламных элементов
\begin{equation}
    \text{Imps} \left(T_0, T_1, \left\{ \mathbf{U} \right\} \right) =
    \sum \limits_{\forall u_j} \text{Imps} \left(u_j, T_0, T_1, \left\{ \mathbf{U} \right\} \right)
\end{equation}

Пример временного ряда, представленного метрикой количества взаимодействий показан на рисунке~\ref{img:impressions}.
\input{inc/images/impressions}

Другой метрикой, количественно описывающей пользовательское поведение, является метрика количества уникальных пользователей,
взаимодействующих с рекламным элементом.

Пусть дана выборка пользователей $\left\{ \mathbf{U} \right\}$ за период времени $\left[T_0, T_1\right]$. Пусть $u_i$
элемент вектора взаимодействия $U$ содержит значение идентификатора пользователя, совершившего взаимодействие, а $u_j$ -- 
индентификатор рекламного элемента, с которым взаимодействие было совершено, тогда
\begin{equation}
    \text{Distinct}\left( A, T_0, T_1, \left\{\mathbf{U}\right\} \right) =
    \begin{cases}
        \left|\left\{u_i\right\}\right|, u_j = A  \\
        0, u_j \neq A
    \end{cases}, \forall t_k \in \left[T_0, T_1\right]
\end{equation}
метрика количества уникальных пользователей, взаимодействующих с рекламным элементом $A$, где 
$\left|\left\{u_i\right\}\right|$ --- мощность множества уникальных пользователей, которые взаимодействовали с рекламным
элементом $A$ в момент времени $t_k$.

Пример временного ряда, представленного метрикой количества уникальных взаимодействий показан на 
рисунке~\ref{img:uniques}.
\input{inc/images/uniques}

Кумулятивная сумма числа уникальных пользователей является метрикой, отражающей  пользовательский траффик. Рост данной
функции отражает увеличение числа посетителей сайта, обратно, уменьшение значения данной функции, отражает отток 
посетителей с интернет-страницы.

Пример временного ряда, представленного кумулятивной суммой количества уникальных взаимодействий показан на 
рисунке~\ref{img:cumsumuniques}.
\input{inc/images/cumsumuniques}